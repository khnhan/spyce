% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/variance_SPYCE_param12.R
\name{variance_SPYCE_param12}
\alias{variance_SPYCE_param12}
\title{Plug-in variance for SPYCE of (beta, sigma) with parametrically estimated \eqn{f_{X\mid Z}} and \eqn{f_{C\mid Y,Z}}}
\usage{
variance_SPYCE_param12(
  beta,
  y_data,
  w_data,
  delta_data,
  z_data = NULL,
  sigma,
  sigma_fixed = NULL,
  w_min,
  w_max,
  tt = 20,
  m = 20
)
}
\arguments{
\item{beta}{Numeric vector of estimated \eqn{\beta}.}

\item{y_data}{Numeric vector.}

\item{w_data}{Numeric vector of \eqn{W=\min(X,C)}.}

\item{delta_data}{Logical or \{0,1\} vector: \eqn{\Delta=1\{X \le C\}}.}

\item{z_data}{Optional numeric vector (default \code{NULL}); if provided, must match length of \code{y_data}.}

\item{sigma}{Numeric scalar \eqn{\hat\sigma}. Ignored when \code{sigma_fixed} is provided.}

\item{sigma_fixed}{Optional positive scalar; if supplied, \eqn{\sigma} is treated as known and the returned variance is for \eqn{\beta} only.}

\item{w_min, w_max}{Numeric bounds used internally (same role as in \code{\link{get_SPYCE_param12}}).}

\item{tt}{Number of grid points where the integral is computed; defaults to 20.}

\item{m}{Number of grid points between \code{w_min} and \code{w_max} for which the integral equation is solved; defaults to 20.}
}
\value{
A variance–covariance matrix:
\itemize{
\item CASE A/B: \code{(length(beta)+1) x (length(beta)+1)}
\item CASE C/D: \code{length(beta) x length(beta)}
}
}
\description{
Computes the plug-in variance–covariance matrix for the SPYCE estimator
\code{\link{get_SPYCE_param12}}. Supports four modes matching that estimator:
\itemize{
\item \strong{CASE A}: estimate \eqn{(\beta,\sigma)} with \code{z_data}
\item \strong{CASE B}: estimate \eqn{(\beta,\sigma)} without \code{z_data}
\item \strong{CASE C}: estimate \eqn{\beta} with \code{z_data} and fixed \code{sigma}
\item \strong{CASE D}: estimate \eqn{\beta} without \code{z_data} and fixed \code{sigma}
}
It is recommended to use the same \code{w_min}, \code{w_max}, \code{tt}, and \code{m} as in \code{\link{get_SPYCE_param12}}.
}
\examples{
library(truncnorm)
set.seed(1)
n = 500; beta = c(0, 3); sigma = 4
# Data generation
# Y|X ~ N(beta_0 + beta_1 X, 1)
x_data = rtruncnorm(n, a = -1, b = 1, mean = 0, sd = 1)
y_data = cbind(1,x_data) \%*\% beta + sigma * rnorm(n)
c_data = rtruncnorm(n, a = -1, b = 1, mean = 0, sd = 1)
z_data = rbinom(n, size = 1, prob = 0.6)
# Generate W and Delta from X and C
w_data = pmin(c_data,x_data)
delta_data = as.numeric(x_data<=c_data)
# Set w_min and w_max
w_min = min(w_data) - sd(w_data)
w_max = max(w_data) + sd(w_data)
# CASE A: true = (0, 3, 0, 0, 4)
variance_SPYCE_param12(beta = c(0.5, 2.5, 0.1, 0.1),
                       y_data,
                       w_data,
                       delta_data,
                       z_data,
                       sigma = 3.5,
                       w_min = w_min, w_max = w_max)
# CASE B: true = (0, 3, 4)
variance_SPYCE_param12(beta = c(0.5, 2.5),
                       y_data,
                       w_data,
                       delta_data,
                       sigma = 3.5,
                       w_min = w_min, w_max = w_max)
# CASE C: true = (0, 3, 0, 0)
variance_SPYCE_param12(beta = c(0.5, 2.5, 0.1, 0.1),
                       y_data,
                       w_data,
                       delta_data,
                       z_data,
                       sigma_fixed = 4,
                       w_min = w_min, w_max = w_max)
# CASE D: true = (0, 3)
variance_SPYCE_param12(beta = c(0.5, 2.5),
                       y_data,
                       w_data,
                       delta_data,
                       sigma_fixed = 4,
                       w_min = w_min, w_max = w_max)
}
